<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <title>ü•Ç –ó –î–Ω–µ–º –ù–∞—Ä–æ–¥–∂–µ–Ω–Ω—è, –í–∞–¥—ñ–∫!</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            margin: 0;
            overflow: hidden;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: #000; /* –ó–∞–ø–∞—Å–Ω–∏–π —Ñ–æ–Ω */
        }
        
        /* –í—ñ–¥–µ–æ —è–∫ —Ñ–æ–Ω */
        #videoBackground {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            object-fit: cover; /* –ó–∞–ø–æ–≤–Ω—é—î –µ–∫—Ä–∞–Ω */
            transform: scaleX(-1); /* –î–∑–µ—Ä–∫–∞–ª—å–Ω–µ –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è */
            z-index: 1;
            display: none; /* –°–ø–æ—á–∞—Ç–∫—É –ø—Ä–∏—Ö–æ–≤–∞–Ω–æ */
        }
        
        /* Canvas –¥–ª—è Three.js –ø–æ–≤–µ—Ä—Ö –≤—ñ–¥–µ–æ */
        #canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 2; /* –í–∏—â–µ –∑–∞ –≤—ñ–¥–µ–æ */
            pointer-events: none; /* –©–æ–± –Ω–µ –±–ª–æ–∫—É–≤–∞–≤ –∫–ª—ñ–∫–∏ */
        }
        
        /* –Ü–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø–æ–≤–µ—Ä—Ö —É—Å—å–æ–≥–æ */
        #startButton {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            padding: 20px 40px;
            font-size: 24px;
            background: linear-gradient(135deg, #ffd700, #ffed4e);
            border: none;
            border-radius: 15px;
            cursor: pointer;
            z-index: 10;
            transition: all 0.3s ease;
            color: #000;
            font-weight: bold;
            box-shadow: 0 10px 30px rgba(255, 215, 0, 0.5);
            animation: pulse 2s infinite;
        }
        
        #greeting {
            position: fixed;
            top: 10%;
            left: 50%;
            transform: translateX(-50%);
            width: 90%;
            max-width: 600px;
            text-align: center;
            color: white;
            font-size: clamp(20px, 5vw, 36px);
            font-weight: bold;
            text-shadow: 2px 2px 10px rgba(0,0,0,0.9);
            display: none;
            z-index: 10;
            padding: 25px;
            background: linear-gradient(135deg, rgba(255, 107, 107, 0.9), rgba(255, 183, 77, 0.9));
            border-radius: 20px;
            backdrop-filter: blur(10px);
            border: 3px solid rgba(255, 255, 255, 0.8);
            box-shadow: 0 15px 50px rgba(0,0,0,0.4);
        }
        
        #loading, #error, .instructions {
            position: fixed;
            left: 50%;
            transform: translateX(-50%);
            color: white;
            text-align: center;
            z-index: 10;
            padding: 15px 25px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
            background: rgba(0, 0, 0, 0.7);
            display: none;
        }
        
        #loading { top: 10%; font-size: 18px; }
        #error { 
            top: 10%; 
            color: #ff6b6b; 
            font-size: 16px;
            border: 2px solid #ff6b6b;
            max-width: 500px;
            width: 90%;
        }
        .instructions { 
            bottom: 30px; 
            font-size: 16px;
            border: 2px solid #4ecdc4;
            max-width: 400px;
            width: 90%;
        }
        
        @keyframes pulse {
            0% { transform: translate(-50%, -50%) scale(1); }
            50% { transform: translate(-50%, -50%) scale(1.05); }
            100% { transform: translate(-50%, -50%) scale(1); }
        }
        
        @keyframes sparkle {
            0% { transform: scale(0) rotate(0deg); opacity: 1; }
            100% { transform: scale(1) rotate(360deg); opacity: 0; }
        }
    </style>
</head>
<body>
    <!-- –í—ñ–¥–µ–æ—Ñ–æ–Ω (—Å–ø–æ—á–∞—Ç–∫—É –ø—Ä–∏—Ö–æ–≤–∞–Ω–æ) -->
    <video id="videoBackground" playsinline></video>
    
    <!-- Canvas –¥–ª—è Three.js -->
    <canvas id="canvas"></canvas>
    
    <!-- –Ü–Ω—Ç–µ—Ä—Ñ–µ–π—Å -->
    <button id="startButton">üéâ –ó–∞–ø—É—Å—Ç–∏—Ç–∏ AR-–ø—Ä–∏–≤—ñ—Ç–∞–Ω–Ω—è</button>
    <div id="greeting">–ó –î–Ω–µ–º –ù–∞—Ä–æ–¥–∂–µ–Ω–Ω—è, –í–∞–¥—ñ–∫!<br>–ó–∞ —Ç–≤–æ—î –∑–¥–æ—Ä–æ–≤'—è, —É—Å–ø—ñ—Ö–∏ —Ç–∞ –∫—Ä—É—Ç—ñ –ø—Ä–∏–≥–æ–¥–∏! ü•Ç</div>
    <div id="loading">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Å–∏—Å—Ç–µ–º–∏ —Ä–æ–∑–ø—ñ–∑–Ω–∞–≤–∞–Ω–Ω—è —Ä—É–∫...</div>
    <div id="error"></div>
    <div class="instructions">üñêÔ∏è –ü–æ–∫–∞–∂—ñ—Ç—å –¥–æ–ª–æ–Ω—é –∫–∞–º–µ—Ä—ñ<br>üëâ –ó–≤–µ–¥—ñ—Ç—å –≤–µ–ª–∏–∫–∏–π —Ç–∞ –≤–∫–∞–∑—ñ–≤–Ω–∏–π –ø–∞–ª—å—Ü—ñ –¥–ª—è —Ç–æ—Å—Ç—É!</div>

    <!-- –ë—ñ–±–ª—ñ–æ—Ç–µ–∫–∏ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/hands@0.4.1646424915/hands.min.js"></script>

    <script>
        (function() {
            'use strict';
            
            // DOM-–µ–ª–µ–º–µ–Ω—Ç–∏
            const videoBackground = document.getElementById('videoBackground');
            const canvas = document.getElementById('canvas');
            const startButton = document.getElementById('startButton');
            const greeting = document.getElementById('greeting');
            const loading = document.getElementById('loading');
            const errorDiv = document.getElementById('error');
            const instructions = document.querySelector('.instructions');
            
            // –ì–ª–æ–±–∞–ª—å–Ω—ñ –∑–º—ñ–Ω–Ω—ñ
            let videoForProcessing = null; // –ü—Ä–∏—Ö–æ–≤–∞–Ω–µ –≤—ñ–¥–µ–æ –¥–ª—è MediaPipe
            let scene, camera, renderer, glassGroup, hands;
            let isRunning = false;
            let lastPinchTime = 0; // –î–ª—è –∑–∞–ø–æ–±—ñ–≥–∞–Ω–Ω—è —Å–ø–∞–º—É —ñ—Å–∫—Ä–∞–º–∏
            
            // ====== –Ü–ù–Ü–¶–Ü–ê–õ–Ü–ó–ê–¶–Ü–Ø ======
            function init() {
                try {
                    // –°—Ç–≤–æ—Ä—é—î–º–æ –ø—Ä–∏—Ö–æ–≤–∞–Ω–µ –≤—ñ–¥–µ–æ –¥–ª—è MediaPipe
                    videoForProcessing = document.createElement('video');
                    videoForProcessing.autoplay = true;
                    videoForProcessing.playsInline = true;
                    videoForProcessing.style.display = 'none';
                    document.body.appendChild(videoForProcessing);
                    
                    // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É—î–º–æ Three.js
                    initThreeJS();
                    
                    // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É—î–º–æ MediaPipe Hands
                    initMediaPipe();
                    
                    console.log('‚úÖ –°–∏—Å—Ç–µ–º–∞ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–æ–≤–∞–Ω–∞');
                } catch (err) {
                    showError('–ü–æ–º–∏–ª–∫–∞ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó: ' + err.message);
                }
            }
            
            // ====== THREE.JS ======
            function initThreeJS() {
                // –°—Ü–µ–Ω–∞
                scene = new THREE.Scene();
                scene.background = null; // –ü—Ä–æ–∑–æ—Ä–∏–π —Ñ–æ–Ω
                
                // –ö–∞–º–µ—Ä–∞
                camera = new THREE.PerspectiveCamera(
                    60, 
                    window.innerWidth / window.innerHeight, 
                    0.1, 
                    1000
                );
                camera.position.set(0, 0, 5);
                
                // –†–µ–Ω–¥–µ—Ä–µ—Ä
                renderer = new THREE.WebGLRenderer({
                    canvas: canvas,
                    antialias: true,
                    alpha: true,
                    preserveDrawingBuffer: false
                });
                renderer.setSize(window.innerWidth, window.innerHeight);
                renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
                renderer.setClearColor(0x000000, 0); // –ü–æ–≤–Ω—ñ—Å—Ç—é –ø—Ä–æ–∑–æ—Ä–∏–π
                
                // –û—Å–≤—ñ—Ç–ª–µ–Ω–Ω—è
                const ambientLight = new THREE.AmbientLight(0xffffff, 0.8);
                scene.add(ambientLight);
                
                const directionalLight = new THREE.DirectionalLight(0xffffff, 1);
                directionalLight.position.set(10, 10, 5);
                scene.add(directionalLight);
                
                // –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –∫–µ–ª–∏—Ö–∞
                createChampagneGlass();
            }
            
            // ====== 3D-–ö–ï–õ–ò–• ======
            function createChampagneGlass() {
                glassGroup = new THREE.Group();
                
                // –ù—ñ–∂–∫–∞ (–∑–æ–ª–æ—Ç–∞)
                const stemGeometry = new THREE.CylinderGeometry(0.02, 0.025, 0.3, 16);
                const stemMaterial = new THREE.MeshPhongMaterial({
                    color: 0xFFD700,
                    shininess: 100,
                    specular: 0x333333
                });
                const stem = new THREE.Mesh(stemGeometry, stemMaterial);
                stem.position.y = 0.15;
                glassGroup.add(stem);
                
                // –ß–∞—à–∞ (–∫—Ä–∏—à—Ç–∞–ª–µ–≤–∞)
                const bowlGeometry = new THREE.CylinderGeometry(0.12, 0.09, 0.25, 32);
                const bowlMaterial = new THREE.MeshPhysicalMaterial({
                    color: 0xFFFFFF,
                    transparent: true,
                    opacity: 0.4,
                    transmission: 0.95,
                    roughness: 0.05,
                    metalness: 0,
                    clearcoat: 1,
                    clearcoatRoughness: 0.1
                });
                const bowl = new THREE.Mesh(bowlGeometry, bowlMaterial);
                bowl.position.y = 0.4;
                glassGroup.add(bowl);
                
                // –®–∞–º–ø–∞–Ω—Å—å–∫–µ (—Ä—ñ–¥–∏–Ω–∞)
                const liquidGeometry = new THREE.SphereGeometry(0.1, 32, 32, 0, Math.PI * 2, 0, Math.PI / 2);
                const liquidMaterial = new THREE.MeshPhongMaterial({
                    color: 0xFFF8DC,
                    transparent: true,
                    opacity: 0.9,
                    shininess: 100
                });
                const liquid = new THREE.Mesh(liquidGeometry, liquidMaterial);
                liquid.position.y = 0.35;
                liquid.scale.y = 0.5;
                glassGroup.add(liquid);
                
                // –ë—É–ª—å–±–∞—à–∫–∏
                for (let i = 0; i < 25; i++) {
                    const size = 0.004 + Math.random() * 0.012;
                    const bubbleGeometry = new THREE.SphereGeometry(size, 8, 8);
                    const bubbleMaterial = new THREE.MeshPhongMaterial({
                        color: 0xFFFFFF,
                        transparent: true,
                        opacity: 0.8
                    });
                    const bubble = new THREE.Mesh(bubbleGeometry, bubbleMaterial);
                    
                    bubble.position.set(
                        (Math.random() - 0.5) * 0.15,
                        0.35 + Math.random() * 0.12,
                        (Math.random() - 0.5) * 0.15
                    );
                    
                    glassGroup.add(bubble);
                }
                
                scene.add(glassGroup);
                glassGroup.visible = false;
            }
            
            // ====== MEDIAPIPE HANDS ======
            function initMediaPipe() {
                hands = new self.Hands({
                    locateFile: (file) => {
                        return `https://cdn.jsdelivr.net/npm/@mediapipe/hands@0.4.1646424915/${file}`;
                    }
                });
                
                hands.setOptions({
                    maxNumHands: 1,
                    modelComplexity: 1,
                    minDetectionConfidence: 0.7,
                    minTrackingConfidence: 0.7
                });
                
                hands.onResults(onHandResults);
            }
            
            // ====== –ó–ê–ü–£–°–ö –ö–ê–ú–ï–†–ò ======
            async function startCamera() {
                try {
                    hideError();
                    loading.style.display = 'block';
                    startButton.style.display = 'none';
                    
                    const constraints = {
                        video: {
                            facingMode: 'user',
                            width: { ideal: 1280 },
                            height: { ideal: 720 },
                            frameRate: { ideal: 30 }
                        }
                    };
                    
                    if (!navigator.mediaDevices?.getUserMedia) {
                        throw new Error('–ë—Ä–∞—É–∑–µ—Ä –Ω–µ –ø—ñ–¥—Ç—Ä–∏–º—É—î –∫–∞–º–µ—Ä—É');
                    }
                    
                    // –û—Ç—Ä–∏–º—É—î–º–æ –ø–æ—Ç—ñ–∫ –∑ –∫–∞–º–µ—Ä–∏
                    const stream = await navigator.mediaDevices.getUserMedia(constraints);
                    
                    // –ü—ñ–¥–∫–ª—é—á–∞—î–º–æ –ø–æ—Ç—ñ–∫ –¥–æ –î–í–û–• –≤—ñ–¥–µ–æ-–µ–ª–µ–º–µ–Ω—Ç—ñ–≤:
                    // 1. –î–ª—è —Ñ–æ–Ω—É (–≤–∏–¥–∏–º–∏–π)
                    videoBackground.srcObject = stream;
                    // 2. –î–ª—è MediaPipe (–ø—Ä–∏—Ö–æ–≤–∞–Ω–∏–π)
                    videoForProcessing.srcObject = stream;
                    
                    // –ß–µ–∫–∞—î–º–æ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—ñ –≤—ñ–¥–µ–æ
                    await Promise.all([
                        new Promise(resolve => videoBackground.onloadedmetadata = resolve),
                        new Promise(resolve => videoForProcessing.onloadedmetadata = resolve)
                    ]);
                    
                    // –ó–∞–ø—É—Å–∫–∞—î–º–æ –≤—ñ–¥—Ç–≤–æ—Ä–µ–Ω–Ω—è
                    videoBackground.play();
                    videoForProcessing.play();
                    
                    // –ü–æ–∫–∞–∑—É—î–º–æ –≤—ñ–¥–µ–æ—Ñ–æ–Ω
                    videoBackground.style.display = 'block';
                    
                    // –ó–∞–ø—É—Å–∫–∞—î–º–æ –æ–±—Ä–æ–±–∫—É –∫–∞–¥—Ä—ñ–≤
                    startProcessing();
                    
                    // –Ü–Ω—Ç–µ—Ä—Ñ–µ–π—Å
                    loading.style.display = 'none';
                    instructions.style.display = 'block';
                    isRunning = true;
                    
                    console.log('üìπ –ö–∞–º–µ—Ä–∞ –∑–∞–ø—É—â–µ–Ω–∞, –≤—ñ–¥–µ–æ—Ñ–æ–Ω –∞–∫—Ç–∏–≤–Ω–∏–π');
                    
                } catch (err) {
                    console.error('‚ùå –ü–æ–º–∏–ª–∫–∞ –∫–∞–º–µ—Ä–∏:', err);
                    showError('–ù–µ –≤–¥–∞–ª–æ—Å—è –∑–∞–ø—É—Å—Ç–∏—Ç–∏ –∫–∞–º–µ—Ä—É: ' + err.message + 
                              '\n\n1. –î–æ–∑–≤–æ–ª—å—Ç–µ –¥–æ—Å—Ç—É–ø –¥–æ –∫–∞–º–µ—Ä–∏\n2. –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ –∫–∞–º–µ—Ä–∞ –Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è —ñ–Ω—à–æ—é –ø—Ä–æ–≥—Ä–∞–º–æ—é\n3. –°–ø—Ä–æ–±—É–π—Ç–µ —ñ–Ω—à–∏–π –±—Ä–∞—É–∑–µ—Ä (Chrome/Edge/Safari)');
                }
            }
            
            // ====== –û–ë–†–û–ë–ö–ê –ö–ê–î–†–Ü–í MEDIAPIPE ======
            function startProcessing() {
                function processFrame() {
                    if (!isRunning) return;
                    
                    try {
                        if (videoForProcessing.readyState >= videoForProcessing.HAVE_ENOUGH_DATA) {
                            hands.send({image: videoForProcessing});
                        }
                        requestAnimationFrame(processFrame);
                    } catch (err) {
                        console.error('–ü–æ–º–∏–ª–∫–∞ –æ–±—Ä–æ–±–∫–∏ –∫–∞–¥—Ä—É:', err);
                    }
                }
                processFrame();
            }
            
            // ====== –û–ë–†–û–ë–ö–ê –†–ï–ó–£–õ–¨–¢–ê–¢–Ü–í –†–û–ó–ü–Ü–ó–ù–ê–ù–ù–Ø ======
            function onHandResults(results) {
                if (!isRunning) return;
                
                try {
                    if (results.multiHandLandmarks?.length > 0) {
                        const landmarks = results.multiHandLandmarks[0];
                        
                        // –¶–µ–Ω—Ç—Ä –¥–æ–ª–æ–Ω—ñ
                        const wrist = landmarks[0];
                        const middleBase = landmarks[9];
                        
                        // –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –¥–ª—è Three.js
                        const x = (wrist.x - 0.5) * 6;
                        const y = (0.5 - wrist.y) * 4;
                        const z = -wrist.z * 2;
                        
                        // –ü–ª–∞–≤–Ω–∞ –∞–Ω—ñ–º–∞—Ü—ñ—è –ø–æ–∑–∏—Ü—ñ—ó
                        glassGroup.position.lerp(new THREE.Vector3(x, y, z), 0.2);
                        glassGroup.visible = true;
                        
                        // –û–±–µ—Ä—Ç–∞–Ω–Ω—è
                        glassGroup.rotation.y += 0.01;
                        
                        // –î–µ—Ç–µ–∫—Ü—ñ—è "—â–∏–ø–∫–∞" (–≤–µ–ª–∏–∫–∏–π + –≤–∫–∞–∑—ñ–≤–Ω–∏–π –ø–∞–ª—å—Ü—ñ)
                        const thumbTip = landmarks[4];
                        const indexTip = landmarks[8];
                        const distance = Math.sqrt(
                            Math.pow(thumbTip.x - indexTip.x, 2) +
                            Math.pow(thumbTip.y - indexTip.y, 2) +
                            Math.pow(thumbTip.z - indexTip.z, 2)
                        );
                        
                        const isPinching = distance < 0.05;
                        const now = Date.now();
                        
                        if (isPinching && now - lastPinchTime > 1000) {
                            // –ü–æ–∫–∞–∑—É—î–º–æ –ø—Ä–∏–≤—ñ—Ç–∞–Ω–Ω—è
                            greeting.style.display = 'block';
                            greeting.style.animation = 'none';
                            setTimeout(() => {
                                greeting.style.animation = 'fadeIn 0.5s';
                            }, 10);
                            
                            // –°—Ç–≤–æ—Ä—é—î–º–æ —ñ—Å–∫—Ä–∏
                            createSparkles();
                            lastPinchTime = now;
                        } else if (!isPinching) {
                            greeting.style.display = 'none';
                        }
                        
                    } else {
                        // –†—É–∫–∞ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–∞
                        glassGroup.visible = false;
                        greeting.style.display = 'none';
                    }
                } catch (err) {
                    console.error('–ü–æ–º–∏–ª–∫–∞ –æ–±—Ä–æ–±–∫–∏ —Ä—É–∫:', err);
                }
            }
            
            // ====== –ï–§–ï–ö–¢ –Ü–°–ö–û–† ======
            function createSparkles() {
                const colors = ['#FFD700', '#FF6B6B', '#4ECDC4', '#FF8E53'];
                
                for (let i = 0; i < 20; i++) {
                    setTimeout(() => {
                        const sparkle = document.createElement('div');
                        const color = colors[Math.floor(Math.random() * colors.length)];
                        
                        sparkle.style.cssText = `
                            position: fixed;
                            width: ${10 + Math.random() * 25}px;
                            height: ${10 + Math.random() * 25}px;
                            background: radial-gradient(circle, ${color}, transparent);
                            border-radius: 50%;
                            pointer-events: none;
                            top: ${10 + Math.random() * 80}%;
                            left: ${Math.random() * 100}%;
                            box-shadow: 0 0 20px ${color};
                            animation: sparkle ${0.5 + Math.random()}s forwards;
                            z-index: 5;
                        `;
                        
                        document.body.appendChild(sparkle);
                        setTimeout(() => sparkle.remove(), 1000);
                    }, i * 30);
                }
            }
            
            // ====== –î–û–ü–û–ú–Ü–ñ–ù–Ü –§–£–ù–ö–¶–Ü–á ======
            function showError(message) {
                errorDiv.innerHTML = `‚ö†Ô∏è ${message}`;
                errorDiv.style.display = 'block';
                startButton.style.display = 'block';
                loading.style.display = 'none';
            }
            
            function hideError() {
                errorDiv.style.display = 'none';
            }
            
            // ====== –ê–ù–Ü–ú–ê–¶–Ü–ô–ù–ò–ô –¶–ò–ö–õ ======
            function animate() {
                requestAnimationFrame(animate);
                if (renderer && scene && camera) {
                    renderer.render(scene, camera);
                }
            }
            
            // ====== –û–ë–†–û–ë–ù–ò–ö–ò –ü–û–î–Ü–ô ======
            function setupEventListeners() {
                // –ó–∞–ø—É—Å–∫ –¥–æ–¥–∞—Ç–∫—É
                startButton.addEventListener('click', startCamera);
                
                // –ê–¥–∞–ø—Ç–∞—Ü—ñ—è –¥–æ —Ä–æ–∑–º—ñ—Ä—É –≤—ñ–∫–Ω–∞
                window.addEventListener('resize', () => {
                    if (camera && renderer) {
                        camera.aspect = window.innerWidth / window.innerHeight;
                        camera.updateProjectionMatrix();
                        renderer.setSize(window.innerWidth, window.innerHeight);
                    }
                });
                
                // –°–ø—Ä–æ–±–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫—É –Ω–∞ –¥–µ—Å–∫—Ç–æ–ø–∞—Ö
                if (window.innerWidth > 768 && !/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)) {
                    setTimeout(() => {
                        console.log('üñ•Ô∏è –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π –∑–∞–ø—É—Å–∫ –Ω–∞ –¥–µ—Å–∫—Ç–æ–ø—ñ');
                        startButton.style.background = 'linear-gradient(135deg, #4ECDC4, #44A08D)';
                        startButton.textContent = 'üé• –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ 3...';
                        
                        setTimeout(() => {
                            startButton.textContent = 'üé• –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ 2...';
                        }, 1000);
                        
                        setTimeout(() => {
                            startButton.textContent = 'üé• –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ 1...';
                        }, 2000);
                        
                        setTimeout(() => {
                            startCamera();
                        }, 3000);
                    }, 1000);
                }
            }
            
            // ====== –ó–£–ü–ò–ù–ö–ê –î–û–î–ê–¢–ö–£ ======
            function stopApp() {
                isRunning = false;
                
                // –ó—É–ø–∏–Ω—è—î–º–æ –ø–æ—Ç—ñ–∫ –∫–∞–º–µ—Ä–∏
                if (videoBackground.srcObject) {
                    videoBackground.srcObject.getTracks().forEach(track => track.stop());
                }
                if (videoForProcessing?.srcObject) {
                    videoForProcessing.srcObject.getTracks().forEach(track => track.stop());
                }
                
                // –•–æ–≤–∞—î–º–æ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å
                videoBackground.style.display = 'none';
                glassGroup.visible = false;
                greeting.style.display = 'none';
                instructions.style.display = 'none';
                startButton.style.display = 'block';
                loading.style.display = 'none';
            }
            
            // ====== –Ü–ù–Ü–¶–Ü–ê–õ–Ü–ó–ê–¶–Ü–Ø –ü–†–ò –ó–ê–í–ê–ù–¢–ê–ñ–ï–ù–ù–Ü ======
            window.addEventListener('DOMContentLoaded', () => {
                init();
                setupEventListeners();
                animate();
            });
            
            // –ï–∫—Å–ø–æ—Ä—Ç –¥–ª—è –¥–µ–±–∞–≥—É
            window.app = { stopApp, startCamera };
            
        })();
    </script>
</body>
</html>
